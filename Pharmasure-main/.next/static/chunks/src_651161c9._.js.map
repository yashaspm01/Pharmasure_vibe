{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/ai/flows/medicine-label-analysis.ts"],"sourcesContent":["\n'use server';\n\n/**\n * @fileOverview An AI agent that extracts key details from a medicine label image using OCR.\n *\n * - analyzeMedicineLabel - A function that handles the medicine label analysis.\n * - MedicineLabelAnalysisInput - The input type for the analyzeMedicineLabel function.\n * - MedicineLabelAnalysisOutput - The return type for the analyzeMedicineLabel function.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\n\nconst MedicineLabelAnalysisInputSchema = z.object({\n  medicineImage: z\n    .string()\n    .describe(\n      \"A photo of a medicine label, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'.\"\n    ),\n});\nexport type MedicineLabelAnalysisInput = z.infer<typeof MedicineLabelAnalysisInputSchema>;\n\nconst MedicineLabelAnalysisOutputSchema = z.object({\n  isMedicineLabel: z.boolean().describe('Whether the image appears to be a medicine label or box.'),\n  medicineName: z.string().describe('The name of the medicine.'),\n  strength: z.string().optional().describe('The strength of the medicine (e.g., 500mg, 10ml). This is often the same as dosage.'),\n  manufacturer: z.string().optional().describe('The name of the company that manufactured the medicine.'),\n  manufactureDate: z.string().describe('The manufacturing date found on the label (e.g., \"Jan 2023\", \"01/23\").'),\n  expiryDate: z.string().describe('The expiry date found on the label (e.g., \"Dec 2025\", \"12/25\"). This field is required.'),\n  batchNumber: z.string().optional().describe('The batch number of the medicine, often labeled as \"B.No.\" or \"Batch No.\"'),\n});\nexport type MedicineLabelAnalysisOutput = z.infer<typeof MedicineLabelAnalysisOutputSchema>;\n\nexport async function analyzeMedicineLabel(\n  input: MedicineLabelAnalysisInput\n): Promise<MedicineLabelAnalysisOutput> {\n  return medicineLabelAnalysisFlow(input);\n}\n\nconst medicineLabelAnalysisPrompt = ai.definePrompt({\n  name: 'medicineLabelAnalysisPrompt',\n  input: {schema: MedicineLabelAnalysisInputSchema},\n  output: {schema: MedicineLabelAnalysisOutputSchema},\n  prompt: `You are an AI assistant specialized in analyzing medicine labels.\n\n  Your first task is to determine if the provided image is a medicine label, box, or crimp part of a tablet strip.\n  - If it is, set 'isMedicineLabel' to true and extract the details.\n  - If it is NOT a medicine label (e.g., a picture of a car, a landscape, a person), set 'isMedicineLabel' to false and leave the other fields empty.\n\n\n  Analyze the provided image and extract the following details:\n  1. The name of the medicine.\n  2. The strength of the medicine (e.g., 500mg, 10ml).\n  3. The manufacturer's name.\n  4. The manufacturing date.\n  5. The expiry date. This is a required field.\n  6. The batch number (often labeled as \"B.No.\" or similar).\n\n\n  Here is the image:\n  {{media url=medicineImage}}\n\n  Return a JSON object containing the extracted details. If a detail is not visible, return an empty string for that field.\n  `,\n});\n\nconst medicineLabelAnalysisFlow = ai.defineFlow(\n  {\n    name: 'medicineLabelAnalysisFlow',\n    inputSchema: MedicineLabelAnalysisInputSchema,\n    outputSchema: MedicineLabelAnalysisOutputSchema,\n  },\n  async input => {\n    const {output} = await medicineLabelAnalysisPrompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;;IAkCsB,uBAAA,WAAA,GAAA,CAAA,GAAA,yNAAA,CAAA,wBAAA,EAAA,8CAAA,yNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,yNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG3B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,6LAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,oKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/components/ui/accordion.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,YAAY,wKAAA,CAAA,OAAuB;AAEzC,MAAM,8BAAgB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,wKAAA,CAAA,OAAuB;QACtB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QACzB,GAAG,KAAK;;;;;;;AAGb,cAAc,WAAW,GAAG;AAE5B,MAAM,iCAAmB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGtC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,wKAAA,CAAA,SAAyB;QAAC,WAAU;kBACnC,cAAA,6LAAC,wKAAA,CAAA,UAA0B;YACzB,KAAK;YACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,gIACA;YAED,GAAG,KAAK;;gBAER;8BACD,6LAAC,uNAAA,CAAA,cAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;;AAI7B,iBAAiB,WAAW,GAAG,wKAAA,CAAA,UAA0B,CAAC,WAAW;AAErE,MAAM,iCAAmB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGtC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,wKAAA,CAAA,UAA0B;QACzB,KAAK;QACL,WAAU;QACT,GAAG,KAAK;kBAET,cAAA,6LAAC;YAAI,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,aAAa;sBAAa;;;;;;;;;;;;AAIjD,iBAAiB,WAAW,GAAG,wKAAA,CAAA,UAA0B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/services/scan-service.ts"],"sourcesContent":["'use client';\n\nimport { collection, doc, setDoc, serverTimestamp, type Firestore, deleteDoc } from 'firebase/firestore';\nimport { errorEmitter } from '@/firebase/error-emitter';\nimport { FirestorePermissionError } from '@/firebase/errors';\nimport type { Scan } from '@/lib/types';\n\n/**\n * Saves a new scan document to Firestore. This is now an async operation that throws on error.\n * @param firestore The Firestore instance.\n * @param userId The ID of the authenticated user.\n * @param scanId The pre-generated ID for the scan document.\n * @param scanData The scan data to save.\n */\nexport const saveScan = async (\n  firestore: Firestore,\n  userId: string,\n  scanId: string,\n  scanData: Omit<Scan, 'id' | 'scannedAt'>\n): Promise<void> => {\n  if (!userId) {\n    throw new Error('User must be authenticated to save a scan.');\n  }\n  const scanDocRef = doc(firestore, 'users', userId, 'scans', scanId);\n  \n  const dataToSave = {\n    ...scanData,\n    scannedAt: serverTimestamp(),\n  };\n\n  try {\n    // This is now an async function, so we can await the result.\n    await setDoc(scanDocRef, dataToSave);\n  } catch(serverError: any) {\n    // Create and emit a contextual error if the save fails.\n    const permissionError = new FirestorePermissionError({\n      path: scanDocRef.path,\n      operation: 'create',\n      requestResourceData: dataToSave,\n    });\n    errorEmitter.emit('permission-error', permissionError);\n    // Re-throw the original error so the component's catch block can handle it.\n    throw serverError;\n  };\n};\n\n\n/**\n * Deletes a scan document from Firestore. This is a non-blocking operation.\n * @param firestore The Firestore instance.\n * @param userId The ID of the authenticated user.\n * @param scanId The ID of the scan document to delete.\n */\nexport const deleteScan = async (\n  firestore: Firestore,\n  userId: string,\n  scanId: string\n): Promise<void> => {\n  if (!userId || !scanId) {\n    throw new Error('User ID and Scan ID are required to delete a scan.');\n  }\n  const scanDocRef = doc(firestore, 'users', userId, 'scans', scanId);\n  \n  try {\n    await deleteDoc(scanDocRef);\n  } catch (serverError: any) {\n    const permissionError = new FirestorePermissionError({\n      path: scanDocRef.path,\n      operation: 'delete',\n    });\n    errorEmitter.emit('permission-error', permissionError);\n    throw serverError;\n  }\n};\n"],"names":[],"mappings":";;;;AAEA;AAAA;AACA;AACA;AAJA;;;;AAcO,MAAM,WAAW,OACtB,WACA,QACA,QACA;IAEA,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,aAAa,CAAA,GAAA,sKAAA,CAAA,MAAG,AAAD,EAAE,WAAW,SAAS,QAAQ,SAAS;IAE5D,MAAM,aAAa;QACjB,GAAG,QAAQ;QACX,WAAW,CAAA,GAAA,sKAAA,CAAA,kBAAe,AAAD;IAC3B;IAEA,IAAI;QACF,6DAA6D;QAC7D,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE,YAAY;IAC3B,EAAE,OAAM,aAAkB;QACxB,wDAAwD;QACxD,MAAM,kBAAkB,IAAI,4HAAA,CAAA,2BAAwB,CAAC;YACnD,MAAM,WAAW,IAAI;YACrB,WAAW;YACX,qBAAqB;QACvB;QACA,sIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,oBAAoB;QACtC,4EAA4E;QAC5E,MAAM;IACR;;AACF;AASO,MAAM,aAAa,OACxB,WACA,QACA;IAEA,IAAI,CAAC,UAAU,CAAC,QAAQ;QACtB,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,aAAa,CAAA,GAAA,sKAAA,CAAA,MAAG,AAAD,EAAE,WAAW,SAAS,QAAQ,SAAS;IAE5D,IAAI;QACF,MAAM,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE;IAClB,EAAE,OAAO,aAAkB;QACzB,MAAM,kBAAkB,IAAI,4HAAA,CAAA,2BAAwB,CAAC;YACnD,MAAM,WAAW,IAAI;YACrB,WAAW;QACb;QACA,sIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,oBAAoB;QACtC,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/services/medication-service.ts"],"sourcesContent":["'use client';\n\nimport { collection, addDoc, serverTimestamp, type Firestore, Timestamp } from 'firebase/firestore';\nimport { errorEmitter } from '@/firebase/error-emitter';\nimport { FirestorePermissionError } from '@/firebase/errors';\nimport type { Scan, Product } from '@/lib/types';\n\n/**\n * Parses a potentially ambiguous date string (e.g., \"12/25\", \"Dec 2025\") into a valid Date object.\n * @param expiryDate The date string to parse.\n * @returns A Date object or null if parsing fails.\n */\nconst parseExpiryDate = (expiryDate: string): Date | null => {\n    if (!expiryDate) return null;\n\n    // Normalize date string by replacing separators with spaces\n    const dateStr = expiryDate.replace(/[./-]/g, ' ');\n    const parts = dateStr.split(' ');\n\n    let date: Date;\n\n    // Handles \"MM YYYY\" or \"Month YYYY\" formats\n    if (parts.length === 2) {\n        const [monthStr, yearStr] = parts;\n        const year = parseInt(yearStr.length === 2 ? '20' + yearStr : yearStr);\n        \n        // Attempt to parse month from name or number\n        const monthIndex = isNaN(parseInt(monthStr))\n            ? new Date(Date.parse(monthStr + \" 1, 2012\")).getMonth()\n            : parseInt(monthStr) - 1;\n\n        if (!isNaN(year) && !isNaN(monthIndex) && monthIndex >= 0 && monthIndex < 12) {\n            // Set to the last day of the given month for safety\n            date = new Date(year, monthIndex + 1, 0);\n        } else {\n            return null; // Invalid format\n        }\n    } else {\n        // Fallback for more standard, directly parsable date formats\n        date = new Date(expiryDate);\n    }\n  \n    // Final check if the resulting date is valid\n    if (isNaN(date.getTime())) {\n      return null;\n    }\n  \n    return date;\n};\n\n\n/**\n * Saves a new medication document from a scan to the user's subcollection in Firestore.\n * This is now an async operation that can be awaited.\n * @param firestore The Firestore instance.\n * @param userId The ID of the authenticated user.\n * @param scan The scan data to convert and save as a medication.\n */\nexport const saveMedicationFromScan = async (\n  firestore: Firestore,\n  userId: string,\n  scan: Scan\n): Promise<void> => {\n  if (!userId) {\n    throw new Error('User must be authenticated to save a medication.');\n  }\n\n  const medsCollectionRef = collection(firestore, 'users', userId, 'meds');\n  \n  const parsedDate = parseExpiryDate(scan.expiryDate);\n  if (!parsedDate) {\n    throw new Error(`Could not parse expiry date: ${scan.expiryDate}`);\n  }\n  const isoExpiryDate = parsedDate.toISOString();\n\n  // Convert Scan data to a simplified Product/Medication structure\n  const medicationData: Partial<Product> = {\n    name: scan.name,\n    dosage: scan.strength,\n    status: 'Active',\n    scanDetails: {\n        scannedOn: scan.scannedAt instanceof Timestamp ? scan.scannedAt.toDate().toISOString() : scan.scannedAt.toString(),\n        batchNumber: scan.batchNumber,\n        manufactureDate: scan.mfgDate,\n        expiryDate: scan.expiryDate,\n        source: 'Scan',\n        manufacturer: scan.manufacturer,\n    },\n    expiry: isoExpiryDate,\n    imageUrl: scan.imageUrl,\n  };\n  \n  const dataToSave = {\n    ...medicationData,\n    addedOn: serverTimestamp(),\n  };\n\n  try {\n    await addDoc(medsCollectionRef, dataToSave);\n  } catch (serverError: any) {\n    const permissionError = new FirestorePermissionError({\n      path: medsCollectionRef.path,\n      operation: 'create',\n      requestResourceData: dataToSave,\n    });\n    errorEmitter.emit('permission-error', permissionError);\n    // Re-throw the error to be caught by the calling function in the UI\n    throw serverError;\n  }\n};\n"],"names":[],"mappings":";;;AAEA;AAAA;AACA;AACA;AAJA;;;;AAOA;;;;CAIC,GACD,MAAM,kBAAkB,CAAC;IACrB,IAAI,CAAC,YAAY,OAAO;IAExB,4DAA4D;IAC5D,MAAM,UAAU,WAAW,OAAO,CAAC,UAAU;IAC7C,MAAM,QAAQ,QAAQ,KAAK,CAAC;IAE5B,IAAI;IAEJ,4CAA4C;IAC5C,IAAI,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,CAAC,UAAU,QAAQ,GAAG;QAC5B,MAAM,OAAO,SAAS,QAAQ,MAAM,KAAK,IAAI,OAAO,UAAU;QAE9D,6CAA6C;QAC7C,MAAM,aAAa,MAAM,SAAS,aAC5B,IAAI,KAAK,KAAK,KAAK,CAAC,WAAW,aAAa,QAAQ,KACpD,SAAS,YAAY;QAE3B,IAAI,CAAC,MAAM,SAAS,CAAC,MAAM,eAAe,cAAc,KAAK,aAAa,IAAI;YAC1E,oDAAoD;YACpD,OAAO,IAAI,KAAK,MAAM,aAAa,GAAG;QAC1C,OAAO;YACH,OAAO,MAAM,iBAAiB;QAClC;IACJ,OAAO;QACH,6DAA6D;QAC7D,OAAO,IAAI,KAAK;IACpB;IAEA,6CAA6C;IAC7C,IAAI,MAAM,KAAK,OAAO,KAAK;QACzB,OAAO;IACT;IAEA,OAAO;AACX;AAUO,MAAM,yBAAyB,OACpC,WACA,QACA;IAEA,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,oBAAoB,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE,WAAW,SAAS,QAAQ;IAEjE,MAAM,aAAa,gBAAgB,KAAK,UAAU;IAClD,IAAI,CAAC,YAAY;QACf,MAAM,IAAI,MAAM,CAAC,6BAA6B,EAAE,KAAK,UAAU,EAAE;IACnE;IACA,MAAM,gBAAgB,WAAW,WAAW;IAE5C,iEAAiE;IACjE,MAAM,iBAAmC;QACvC,MAAM,KAAK,IAAI;QACf,QAAQ,KAAK,QAAQ;QACrB,QAAQ;QACR,aAAa;YACT,WAAW,KAAK,SAAS,YAAY,sKAAA,CAAA,YAAS,GAAG,KAAK,SAAS,CAAC,MAAM,GAAG,WAAW,KAAK,KAAK,SAAS,CAAC,QAAQ;YAChH,aAAa,KAAK,WAAW;YAC7B,iBAAiB,KAAK,OAAO;YAC7B,YAAY,KAAK,UAAU;YAC3B,QAAQ;YACR,cAAc,KAAK,YAAY;QACnC;QACA,QAAQ;QACR,UAAU,KAAK,QAAQ;IACzB;IAEA,MAAM,aAAa;QACjB,GAAG,cAAc;QACjB,SAAS,CAAA,GAAA,sKAAA,CAAA,kBAAe,AAAD;IACzB;IAEA,IAAI;QACF,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE,mBAAmB;IAClC,EAAE,OAAO,aAAkB;QACzB,MAAM,kBAAkB,IAAI,4HAAA,CAAA,2BAAwB,CAAC;YACnD,MAAM,kBAAkB,IAAI;YAC5B,WAAW;YACX,qBAAqB;QACvB;QACA,sIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,oBAAoB;QACtC,oEAAoE;QACpE,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 389, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/components/ScanItem.tsx"],"sourcesContent":["\n'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Image from 'next/image';\nimport { Timestamp } from 'firebase/firestore';\nimport { formatDistanceToNow } from 'date-fns';\nimport { useToast } from '@/hooks/use-toast';\nimport { useUser, useFirestore } from '@/firebase';\nimport { saveMedicationFromScan } from '@/services/medication-service';\n\nimport { AccordionContent, AccordionItem, AccordionTrigger } from '@/components/ui/accordion';\nimport { Button } from '@/components/ui/button';\nimport { FileCheck2, Trash2, Pencil, PlusCircle, BellPlus } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport type { Scan } from '@/lib/types';\n\ntype ExpiryStatus = {\n  text: string;\n  color: string;\n};\n\nconst monthMap: { [key: string]: number } = {\n    JAN: 0, FEB: 1, MAR: 2, APR: 3, MAY: 4, JUN: 5,\n    JUL: 6, AUG: 7, SEP: 8, OCT: 9, NOV: 10, DEC: 11\n};\n\nconst parseExpiryDate = (expiryDate?: string): Date | null => {\n    if (!expiryDate) return null;\n\n    // Normalize the date string, e.g., \"JUN.2025\" -> \"JUN 2025\"\n    const dateStr = expiryDate.toUpperCase().replace(/[./-]/g, ' ');\n    const parts = dateStr.split(' ');\n\n    let date: Date;\n\n    if (parts.length === 2) {\n        const [monthStr, yearStr] = parts;\n        const year = parseInt(yearStr.length === 2 ? '20' + yearStr : yearStr);\n        \n        let monthIndex: number | undefined;\n        const monthNum = parseInt(monthStr);\n\n        if (monthStr in monthMap) { // Check for \"JUN\"\n            monthIndex = monthMap[monthStr];\n        } else if (!isNaN(monthNum) && monthNum >= 1 && monthNum <= 12) { // Check for \"06\"\n            monthIndex = monthNum - 1;\n        }\n\n        if (year && monthIndex !== undefined && monthIndex >= 0 && monthIndex < 12) {\n            // Set to the last day of the given month for safety\n            date = new Date(year, monthIndex + 1, 0);\n        } else {\n            return null; // Invalid format\n        }\n    } else {\n        // Fallback for standard parsable date formats\n        date = new Date(expiryDate);\n    }\n  \n    // Check if the resulting date is valid\n    if (isNaN(date.getTime())) {\n      return null;\n    }\n  \n    return date;\n};\n\n\nexport const ScanItem = ({ scan, onDelete }: { scan: Scan & {imageUrl?: string}; onDelete: (id: string) => void }) => {\n  const [expiryStatus, setExpiryStatus] = useState<ExpiryStatus>({ text: 'Checking...', color: 'text-muted-foreground' });\n  const [isAdding, setIsAdding] = useState(false);\n  const router = useRouter();\n  const { toast } = useToast();\n  const { user } = useUser();\n  const firestore = useFirestore();\n\n  useEffect(() => {\n    const getExpiryStatus = (expiryDate?: string): ExpiryStatus => {\n      const date = parseExpiryDate(expiryDate);\n      if (!date) return { text: 'Invalid Date', color: 'text-destructive' };\n      \n      const today = new Date();\n      today.setHours(0, 0, 0, 0); // Compare date part only\n      \n      if (date < today) {\n        return { text: 'Expired', color: 'text-destructive' };\n      }\n\n      const diffTime = date.getTime() - today.getTime();\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n      if (diffDays <= 30) return { text: `Expires in ${diffDays}d`, color: 'text-yellow-600' };\n      \n      return { text: `Expires on ${date.toLocaleDateString()}`, color: 'text-green-600' };\n    };\n\n    setExpiryStatus(getExpiryStatus(scan.expiryDate));\n  }, [scan.expiryDate]);\n\n  const handleAddToMeds = async () => {\n    if (!firestore || !user) {\n        toast({ title: \"Error\", description: \"You must be logged in.\", variant: \"destructive\"});\n        return;\n    }\n    if (!scan.expiryDate) {\n        toast({\n            title: \"Missing Expiry Date\",\n            description: \"Please edit the scan and add an expiry date before adding to your medications.\",\n            variant: \"destructive\"\n        });\n        return;\n    }\n    setIsAdding(true);\n    try {\n        await saveMedicationFromScan(firestore, user.uid, scan);\n        toast({\n            title: \"Medication Added\",\n            description: `${scan.name} has been added to My Meds.`,\n        });\n        router.push('/products');\n    } catch (error) {\n        console.error(\"Failed to add medication:\", error);\n        toast({ title: \"Error\", description: \"Could not add medication. Please try again.\", variant: \"destructive\" });\n    } finally {\n        setIsAdding(false);\n    }\n  };\n\n  const handleSetReminder = () => {\n    router.push(`/reminders?medication=${encodeURIComponent(scan.name)}`);\n  };\n\n  const scannedAtDate = scan.scannedAt instanceof Timestamp ? scan.scannedAt.toDate() : (scan.scannedAt ? new Date(scan.scannedAt) : null);\n\n  return (\n    <AccordionItem value={scan.id}>\n      <AccordionTrigger>\n        <div className='flex justify-between items-center w-full pr-4'>\n          <div className=\"flex items-center gap-3\">\n            {scan.imageUrl ? (\n              <div className=\"relative w-12 h-12 rounded-lg overflow-hidden bg-slate-100\">\n                <Image src={scan.imageUrl} alt={scan.name} fill className=\"object-contain\" />\n              </div>\n            ) : (\n              <div className=\"p-2 bg-white rounded-full shadow-sm\">\n                  <FileCheck2 className=\"h-5 w-5 text-primary\" />\n              </div>\n            )}\n            <div>\n              <p className=\"font-semibold text-left\">{scan.name}</p>\n              {scannedAtDate && !isNaN(scannedAtDate.getTime()) && (\n                <p className=\"text-xs text-muted-foreground text-left\">\n                  Scanned {formatDistanceToNow(scannedAtDate, { addSuffix: true })}\n                </p>\n              )}\n            </div>\n          </div>\n          <p className={cn(\"text-sm font-semibold\", expiryStatus.color)}>{expiryStatus.text}</p>\n        </div>\n      </AccordionTrigger>\n      <AccordionContent>\n        <div className=\"space-y-3 px-2 pt-2 border-t\">\n          <div className='grid grid-cols-2 gap-x-4 gap-y-2 text-sm'>\n            <div><span className='font-semibold'>Strength:</span> {scan.strength}</div>\n            <div><span className='font-semibold'>Batch No:</span> {scan.batchNumber}</div>\n            <div><span className='font-semibold'>Mfg. Date:</span> {scan.mfgDate}</div>\n            <div><span className='font-semibold'>Expiry Date:</span> {scan.expiryDate}</div>\n            <div className='col-span-2'><span className='font-semibold'>Manufacturer:</span> {scan.manufacturer}</div>\n          </div>\n          <div className='flex flex-wrap justify-end gap-2 pt-2'>\n            <Button variant='ghost' size='sm' className='text-destructive hover:text-destructive' onClick={() => onDelete(scan.id)}><Trash2 className='mr-2 h-4 w-4' /> Remove</Button>\n            <Button variant='outline' size='sm'><Pencil className='mr-2 h-4 w-4' /> Edit</Button>\n            <Button size='sm' className='bg-green-600 hover:bg-green-700' onClick={handleAddToMeds} disabled={isAdding}>\n                <PlusCircle className='mr-2 h-4 w-4' /> {isAdding ? 'Adding...' : 'Add to My Meds'}\n            </Button>\n            <Button size='sm' onClick={handleSetReminder}><BellPlus className='mr-2 h-4 w-4' /> Set Reminder</Button>\n          </div>\n        </div>\n      </AccordionContent>\n    </AccordionItem>\n  );\n};\n"],"names":[],"mappings":";;;;AAGA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAdA;;;;;;;;;;;;;AAsBA,MAAM,WAAsC;IACxC,KAAK;IAAG,KAAK;IAAG,KAAK;IAAG,KAAK;IAAG,KAAK;IAAG,KAAK;IAC7C,KAAK;IAAG,KAAK;IAAG,KAAK;IAAG,KAAK;IAAG,KAAK;IAAI,KAAK;AAClD;AAEA,MAAM,kBAAkB,CAAC;IACrB,IAAI,CAAC,YAAY,OAAO;IAExB,4DAA4D;IAC5D,MAAM,UAAU,WAAW,WAAW,GAAG,OAAO,CAAC,UAAU;IAC3D,MAAM,QAAQ,QAAQ,KAAK,CAAC;IAE5B,IAAI;IAEJ,IAAI,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,CAAC,UAAU,QAAQ,GAAG;QAC5B,MAAM,OAAO,SAAS,QAAQ,MAAM,KAAK,IAAI,OAAO,UAAU;QAE9D,IAAI;QACJ,MAAM,WAAW,SAAS;QAE1B,IAAI,YAAY,UAAU;YACtB,aAAa,QAAQ,CAAC,SAAS;QACnC,OAAO,IAAI,CAAC,MAAM,aAAa,YAAY,KAAK,YAAY,IAAI;YAC5D,aAAa,WAAW;QAC5B;QAEA,IAAI,QAAQ,eAAe,aAAa,cAAc,KAAK,aAAa,IAAI;YACxE,oDAAoD;YACpD,OAAO,IAAI,KAAK,MAAM,aAAa,GAAG;QAC1C,OAAO;YACH,OAAO,MAAM,iBAAiB;QAClC;IACJ,OAAO;QACH,8CAA8C;QAC9C,OAAO,IAAI,KAAK;IACpB;IAEA,uCAAuC;IACvC,IAAI,MAAM,KAAK,OAAO,KAAK;QACzB,OAAO;IACT;IAEA,OAAO;AACX;AAGO,MAAM,WAAW,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAwE;;IAC/G,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAgB;QAAE,MAAM;QAAe,OAAO;IAAwB;IACrH,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,+HAAA,CAAA,WAAQ,AAAD;IACzB,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IACvB,MAAM,YAAY,CAAA,GAAA,+HAAA,CAAA,eAAY,AAAD;IAE7B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,MAAM;sDAAkB,CAAC;oBACvB,MAAM,OAAO,gBAAgB;oBAC7B,IAAI,CAAC,MAAM,OAAO;wBAAE,MAAM;wBAAgB,OAAO;oBAAmB;oBAEpE,MAAM,QAAQ,IAAI;oBAClB,MAAM,QAAQ,CAAC,GAAG,GAAG,GAAG,IAAI,yBAAyB;oBAErD,IAAI,OAAO,OAAO;wBAChB,OAAO;4BAAE,MAAM;4BAAW,OAAO;wBAAmB;oBACtD;oBAEA,MAAM,WAAW,KAAK,OAAO,KAAK,MAAM,OAAO;oBAC/C,MAAM,WAAW,KAAK,IAAI,CAAC,WAAW,CAAC,OAAO,KAAK,KAAK,EAAE;oBAE1D,IAAI,YAAY,IAAI,OAAO;wBAAE,MAAM,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;wBAAE,OAAO;oBAAkB;oBAEvF,OAAO;wBAAE,MAAM,CAAC,WAAW,EAAE,KAAK,kBAAkB,IAAI;wBAAE,OAAO;oBAAiB;gBACpF;;YAEA,gBAAgB,gBAAgB,KAAK,UAAU;QACjD;6BAAG;QAAC,KAAK,UAAU;KAAC;IAEpB,MAAM,kBAAkB;QACtB,IAAI,CAAC,aAAa,CAAC,MAAM;YACrB,MAAM;gBAAE,OAAO;gBAAS,aAAa;gBAA0B,SAAS;YAAa;YACrF;QACJ;QACA,IAAI,CAAC,KAAK,UAAU,EAAE;YAClB,MAAM;gBACF,OAAO;gBACP,aAAa;gBACb,SAAS;YACb;YACA;QACJ;QACA,YAAY;QACZ,IAAI;YACA,MAAM,CAAA,GAAA,2IAAA,CAAA,yBAAsB,AAAD,EAAE,WAAW,KAAK,GAAG,EAAE;YAClD,MAAM;gBACF,OAAO;gBACP,aAAa,GAAG,KAAK,IAAI,CAAC,2BAA2B,CAAC;YAC1D;YACA,OAAO,IAAI,CAAC;QAChB,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM;gBAAE,OAAO;gBAAS,aAAa;gBAA+C,SAAS;YAAc;QAC/G,SAAU;YACN,YAAY;QAChB;IACF;IAEA,MAAM,oBAAoB;QACxB,OAAO,IAAI,CAAC,CAAC,sBAAsB,EAAE,mBAAmB,KAAK,IAAI,GAAG;IACtE;IAEA,MAAM,gBAAgB,KAAK,SAAS,YAAY,sKAAA,CAAA,YAAS,GAAG,KAAK,SAAS,CAAC,MAAM,KAAM,KAAK,SAAS,GAAG,IAAI,KAAK,KAAK,SAAS,IAAI;IAEnI,qBACE,6LAAC,wIAAA,CAAA,gBAAa;QAAC,OAAO,KAAK,EAAE;;0BAC3B,6LAAC,wIAAA,CAAA,mBAAgB;0BACf,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;gCACZ,KAAK,QAAQ,iBACZ,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC,gIAAA,CAAA,UAAK;wCAAC,KAAK,KAAK,QAAQ;wCAAE,KAAK,KAAK,IAAI;wCAAE,IAAI;wCAAC,WAAU;;;;;;;;;;yDAG5D,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC,yNAAA,CAAA,aAAU;wCAAC,WAAU;;;;;;;;;;;8CAG5B,6LAAC;;sDACC,6LAAC;4CAAE,WAAU;sDAA2B,KAAK,IAAI;;;;;;wCAChD,iBAAiB,CAAC,MAAM,cAAc,OAAO,qBAC5C,6LAAC;4CAAE,WAAU;;gDAA0C;gDAC5C,CAAA,GAAA,sJAAA,CAAA,sBAAmB,AAAD,EAAE,eAAe;oDAAE,WAAW;gDAAK;;;;;;;;;;;;;;;;;;;sCAKtE,6LAAC;4BAAE,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,yBAAyB,aAAa,KAAK;sCAAI,aAAa,IAAI;;;;;;;;;;;;;;;;;0BAGrF,6LAAC,wIAAA,CAAA,mBAAgB;0BACf,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;;sDAAI,6LAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAgB;wCAAE,KAAK,QAAQ;;;;;;;8CACpE,6LAAC;;sDAAI,6LAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAgB;wCAAE,KAAK,WAAW;;;;;;;8CACvE,6LAAC;;sDAAI,6LAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAiB;wCAAE,KAAK,OAAO;;;;;;;8CACpE,6LAAC;;sDAAI,6LAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAmB;wCAAE,KAAK,UAAU;;;;;;;8CACzE,6LAAC;oCAAI,WAAU;;sDAAa,6LAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAoB;wCAAE,KAAK,YAAY;;;;;;;;;;;;;sCAErG,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,qIAAA,CAAA,SAAM;oCAAC,SAAQ;oCAAQ,MAAK;oCAAK,WAAU;oCAA0C,SAAS,IAAM,SAAS,KAAK,EAAE;;sDAAG,6LAAC,6MAAA,CAAA,SAAM;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CAC3J,6LAAC,qIAAA,CAAA,SAAM;oCAAC,SAAQ;oCAAU,MAAK;;sDAAK,6LAAC,yMAAA,CAAA,SAAM;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CACvE,6LAAC,qIAAA,CAAA,SAAM;oCAAC,MAAK;oCAAK,WAAU;oCAAkC,SAAS;oCAAiB,UAAU;;sDAC9F,6LAAC,qNAAA,CAAA,aAAU;4CAAC,WAAU;;;;;;wCAAiB;wCAAE,WAAW,cAAc;;;;;;;8CAEtE,6LAAC,qIAAA,CAAA,SAAM;oCAAC,MAAK;oCAAK,SAAS;;sDAAmB,6LAAC,iNAAA,CAAA,WAAQ;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM/F;GAjHa;;QAGI,qIAAA,CAAA,YAAS;QACN,+HAAA,CAAA,WAAQ;QACT,+HAAA,CAAA,UAAO;QACN,+HAAA,CAAA,eAAY;;;KANnB","debugId":null}},
    {"offset": {"line": 879, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/services/storage-service.ts"],"sourcesContent":["'use client';\n\nimport { ref, uploadBytes, getDownloadURL, type FirebaseStorage } from 'firebase/storage';\n\n/**\n * Uploads an image file to Firebase Storage and returns its public download URL.\n * @param storage The Firebase Storage instance.\n * @param userId The ID of the current user.\n * @param scanId The unique ID for the scan, used as the image name.\n * @param file The image file to upload.\n * @returns A promise that resolves with the public URL of the uploaded image.\n */\nexport const uploadImageAndGetURL = async (\n  storage: FirebaseStorage,\n  userId: string,\n  scanId: string,\n  file: File\n): Promise<string> => {\n  if (!userId || !scanId || !file) {\n    throw new Error('User ID, Scan ID, and a file are required for upload.');\n  }\n\n  // Create a storage reference\n  const imagePath = `users/${userId}/scans/${scanId}.${file.name.split('.').pop()}`;\n  const storageRef = ref(storage, imagePath);\n\n  try {\n    // Upload the file\n    const snapshot = await uploadBytes(storageRef, file);\n    \n    // Get the download URL\n    const downloadURL = await getDownloadURL(snapshot.ref);\n    \n    return downloadURL;\n  } catch (error) {\n    console.error('Error uploading image to Firebase Storage:', error);\n    // Depending on requirements, you might want to handle different error codes\n    // (e.g., 'storage/unauthorized', 'storage/canceled', 'storage/unknown')\n    throw new Error('Failed to upload image.');\n  }\n};\n"],"names":[],"mappings":";;;AAEA;AAAA;AAFA;;AAYO,MAAM,uBAAuB,OAClC,SACA,QACA,QACA;IAEA,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,MAAM;QAC/B,MAAM,IAAI,MAAM;IAClB;IAEA,6BAA6B;IAC7B,MAAM,YAAY,CAAC,MAAM,EAAE,OAAO,OAAO,EAAE,OAAO,CAAC,EAAE,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI;IACjF,MAAM,aAAa,CAAA,GAAA,oKAAA,CAAA,MAAG,AAAD,EAAE,SAAS;IAEhC,IAAI;QACF,kBAAkB;QAClB,MAAM,WAAW,MAAM,CAAA,GAAA,oKAAA,CAAA,cAAW,AAAD,EAAE,YAAY;QAE/C,uBAAuB;QACvB,MAAM,cAAc,MAAM,CAAA,GAAA,oKAAA,CAAA,iBAAc,AAAD,EAAE,SAAS,GAAG;QAErD,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8CAA8C;QAC5D,4EAA4E;QAC5E,wEAAwE;QACxE,MAAM,IAAI,MAAM;IAClB;AACF","debugId":null}},
    {"offset": {"line": 915, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahes/OneDrive/Desktop/VIBE/Pharmasure-main/src/app/%28pages%29/prescription-upload/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { UploadCloud, Camera, Loader2, FileCheck2, AlertTriangle, X } from 'lucide-react';\nimport { analyzeMedicineLabel, type MedicineLabelAnalysisOutput } from '@/ai/flows/medicine-label-analysis';\nimport { useToast } from '@/hooks/use-toast';\nimport Image from 'next/image';\nimport type { Scan } from '@/lib/types';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Accordion } from '@/components/ui/accordion';\nimport { useUser, useFirestore, useMemoFirebase } from '@/firebase';\nimport { collection, query, orderBy, doc } from 'firebase/firestore';\nimport { saveScan, deleteScan } from '@/services/scan-service';\nimport { ScanItem } from '@/components/ScanItem';\nimport { useCollection } from '@/firebase/firestore/use-collection';\nimport { uploadImageAndGetURL } from '@/services/storage-service';\nimport { getStorage } from 'firebase/storage';\nimport { saveMedicationFromScan } from '@/services/medication-service';\nimport { useRouter } from 'next/navigation';\n\ntype Status = 'idle' | 'previewing' | 'processing' | 'success' | 'error' | 'camera';\n\nexport default function MedicineScanPage() {\n  const [file, setFile] = useState<File | null>(null);\n  const [preview, setPreview] = useState<string | null>(null);\n  const [status, setStatus] = useState<Status>('idle');\n  const [result, setResult] = useState<MedicineLabelAnalysisOutput | null>(null);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [hasCameraPermission, setHasCameraPermission] = useState<boolean | null>(null);\n  \n  const videoRef = useRef<HTMLVideoElement>(null);\n  const { toast } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const router = useRouter();\n\n  const { user } = useUser();\n  const firestore = useFirestore();\n\n  const scansQuery = useMemoFirebase(() => {\n    if (user && firestore) {\n      return query(\n        collection(firestore, 'users', user.uid, 'scans'),\n        orderBy('scannedAt', 'desc')\n      );\n    }\n    return null;\n  }, [user, firestore]);\n\n  const { data: recentScans, isLoading: isLoadingScans, error: scansError } = useCollection<Scan>(scansQuery);\n  \n  useEffect(() => {\n    return () => {\n      // Clean up the camera stream when component unmounts\n      stopCamera();\n    };\n  }, []);\n\n  const startCamera = async () => {\n    setStatus('camera');\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      setHasCameraPermission(true);\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n      }\n    } catch (error) {\n      console.error('Error accessing camera:', error);\n      setHasCameraPermission(false);\n      toast({\n        variant: 'destructive',\n        title: 'Camera Access Denied',\n        description: 'Please enable camera permissions in your browser settings to use this feature.',\n      });\n      setStatus('idle');\n    }\n  };\n\n  const stopCamera = () => {\n    if (videoRef.current && videoRef.current.srcObject) {\n      (videoRef.current.srcObject as MediaStream).getTracks().forEach(track => track.stop());\n      videoRef.current.srcObject = null;\n    }\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFile = e.target.files?.[0];\n    if (selectedFile) {\n      setFile(selectedFile);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setPreview(reader.result as string);\n        setStatus('previewing');\n        setResult(null);\n      };\n      reader.readAsDataURL(selectedFile);\n    }\n  };\n\n  const fileToDataUri = (file: File): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result as string);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  };\n\n  const handleAnalysis = async (fileToProcess: File) => {\n    if (!fileToProcess) return;\n\n    setStatus('processing');\n    setResult(null);\n    setErrorMessage(null);\n\n    try {\n      const medicineImage = await fileToDataUri(fileToProcess);\n      const analysisResult = await analyzeMedicineLabel({ medicineImage });\n\n      if (!analysisResult.isMedicineLabel) {\n        setErrorMessage(\"This doesn't look like a medicine label. Please upload a clear image of a medicine box or strip.\");\n        setStatus('error');\n        return;\n      }\n      if (!analysisResult.expiryDate) {\n        setErrorMessage(\"The expiry date could not be found. Please try a clearer image or a different angle.\");\n        setStatus('error');\n        return;\n      }\n\n      setResult(analysisResult);\n      setStatus('success');\n      toast({ title: 'Analysis Complete' });\n    } catch (error) {\n      console.error('Error analyzing medicine label:', error);\n      setErrorMessage(\"An unexpected error occurred during analysis. Please try again.\");\n      setStatus('error');\n      toast({ title: 'Analysis Failed', variant: 'destructive' });\n    }\n  };\n\n  const handleCapture = () => {\n    if (!videoRef.current) return;\n    const canvas = document.createElement('canvas');\n    canvas.width = videoRef.current.videoWidth;\n    canvas.height = videoRef.current.videoHeight;\n    const context = canvas.getContext('2d');\n    context?.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob((blob) => {\n      if (blob) {\n        const capturedFile = new File([blob], \"capture.jpg\", { type: \"image/jpeg\" });\n        setFile(capturedFile);\n        setPreview(canvas.toDataURL('image/jpeg'));\n        setStatus('previewing');\n        stopCamera();\n      }\n    });\n  };\n\n  const resetState = () => {\n    stopCamera();\n    setFile(null);\n    setPreview(null);\n    setStatus('idle');\n    setResult(null);\n    setErrorMessage(null);\n    if (fileInputRef.current) fileInputRef.current.value = \"\";\n  };\n\n  const handleSaveScan = async (scanResult: MedicineLabelAnalysisOutput, imageFile: File) => {\n    if (!firestore || !user) {\n      toast({ title: \"Save Failed\", description: \"You must be logged in to save.\", variant: 'destructive' });\n      return;\n    }\n  \n    const scanDocRef = doc(collection(firestore, 'users', user.uid, 'scans'));\n    const scanId = scanDocRef.id;\n    const storage = getStorage();\n  \n    try {\n      // Step 1: Upload image\n      const imageUrl = await uploadImageAndGetURL(storage, user.uid, scanId, imageFile);\n  \n      // Step 2: Prepare scan data (for Recent Scans)\n      const scanData: Scan = {\n        id: scanId,\n        name: scanResult.medicineName,\n        strength: scanResult.strength || 'N/A',\n        manufacturer: scanResult.manufacturer || 'N/A',\n        mfgDate: scanResult.manufactureDate || 'N/A',\n        expiryDate: scanResult.expiryDate,\n        batchNumber: scanResult.batchNumber || 'N/A',\n        imageUrl: imageUrl,\n        scannedAt: new Date().toISOString(),\n      };\n  \n      // Step 3: Save to 'scans' subcollection (for Recent Scans list)\n      await saveScan(firestore, user.uid, scanId, scanData);\n  \n      // Step 4: Save to 'meds' subcollection (for My Meds list)\n      await saveMedicationFromScan(firestore, user.uid, scanData);\n  \n      toast({\n        title: \"Saved Successfully!\",\n        description: `${scanResult.medicineName} has been added to your medications.`,\n      });\n      \n      // Step 5: Navigate to the medications page to show the result\n      router.push('/products');\n  \n    } catch (error: any) {\n      console.error(\"Failed to save scan and medication:\", error);\n      toast({\n        title: \"Save Failed\",\n        description: error.message || \"Could not save your scan. Please try again.\",\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleDeleteScan = async (scanId: string) => {\n    if (!firestore || !user) return;\n    try {\n      await deleteScan(firestore, user.uid, scanId);\n      toast({ title: \"Scan Removed\" });\n    } catch (error) {\n      console.error(\"Failed to delete scan:\", error);\n      toast({ title: \"Delete Failed\", variant: 'destructive' });\n    }\n  };\n\n  const renderIdleContent = () => (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-2 gap-4\">\n        <button\n          onClick={() => fileInputRef.current?.click()}\n          className=\"flex flex-col items-center justify-center p-6 bg-secondary/50 rounded-lg border-2 border-dashed hover:border-primary hover:bg-primary/10 transition-all aspect-square\"\n        >\n          <UploadCloud className=\"h-10 w-10 text-primary mb-2\" />\n          <span className=\"font-semibold text-center\">Upload Image</span>\n        </button>\n        <input type=\"file\" ref={fileInputRef} onChange={handleFileChange} accept=\"image/*\" className=\"hidden\" />\n        <button\n          onClick={startCamera}\n          className=\"flex flex-col items-center justify-center p-6 bg-secondary/50 rounded-lg border-2 border-dashed hover:border-primary hover:bg-primary/10 transition-all aspect-square\"\n        >\n          <Camera className=\"h-10 w-10 text-primary mb-2\" />\n          <span className=\"font-semibold text-center\">Use Camera</span>\n        </button>\n      </div>\n    </div>\n  );\n\n  const renderContent = () => {\n    switch (status) {\n      case 'processing':\n        return (\n          <div className=\"flex flex-col items-center justify-center text-center p-8 min-h-[300px]\">\n            <Loader2 className=\"mr-2 h-16 w-16 animate-spin text-primary\" />\n            <p className=\"font-semibold text-lg mt-4\">Analyzing Label...</p>\n          </div>\n        );\n      case 'previewing':\n        return preview && (\n          <div className='space-y-4'>\n            <Image src={preview} alt=\"Preview\" width={400} height={400} className=\"rounded-lg object-contain w-full max-h-64\" />\n            <div className='grid grid-cols-2 gap-4'>\n              <Button variant='outline' onClick={resetState}>Remove</Button>\n              <Button onClick={() => file && handleAnalysis(file)}>Confirm & Analyze</Button>\n            </div>\n          </div>\n        );\n      case 'success':\n        return result && file && (\n          <div className=\"w-full\">\n            <h3 className=\"text-xl font-bold flex items-center gap-2 mb-4\"><FileCheck2 className=\"text-green-600\" /> Extracted Details</h3>\n            <div className=\"space-y-4\">\n              <div className='space-y-2'><Label htmlFor='medName'>Medicine Name</Label><Input id='medName' defaultValue={result.medicineName} /></div>\n              <div className='space-y-2'><Label htmlFor='medStrength'>Strength / Dosage</Label><Input id='medStrength' defaultValue={result.strength || ''} /></div>\n              <div className='space-y-2'><Label htmlFor='manufacturer'>Manufacturer</Label><Input id='manufacturer' defaultValue={result.manufacturer || ''} /></div>\n              <div className='space-y-2'><Label htmlFor='batchNumber'>Batch Number</Label><Input id='batchNumber' defaultValue={result.batchNumber || ''} /></div>\n              <div className='grid grid-cols-2 gap-4'>\n                <div className='space-y-2'><Label htmlFor='mfgDate'>Mfg. Date</Label><Input id='mfgDate' defaultValue={result.manufactureDate || ''} /></div>\n                <div className='space-y-2'><Label htmlFor='expDate'>Expiry Date</Label><Input id='expDate' defaultValue={result.expiryDate} /></div>\n              </div>\n            </div>\n            <div className='grid grid-cols-2 gap-4 mt-6'>\n              <Button variant='outline' onClick={resetState}>Discard</Button>\n              <Button onClick={() => handleSaveScan(result, file)}>Confirm & Save</Button>\n            </div>\n          </div>\n        );\n      case 'error':\n        return (\n          <div className=\"w-full text-center p-8 min-h-[300px] flex flex-col justify-center items-center\">\n            <AlertTriangle className=\"text-destructive h-12 w-12 mx-auto mb-4\" />\n            <p className=\"font-semibold text-lg\">Analysis Failed</p>\n            <p className=\"text-muted-foreground mt-2\">{errorMessage || 'An unknown error occurred.'}</p>\n            <Button onClick={resetState} className='mt-6'>Try Again</Button>\n          </div>\n        );\n      case 'camera':\n        return (\n          <div className=\"w-full space-y-4\">\n            <div className=\"relative w-full aspect-video bg-black rounded-lg overflow-hidden border-2 border-dashed\">\n              <video ref={videoRef} className=\"w-full h-full object-cover\" autoPlay muted playsInline />\n              {/* Camera guides */}\n            </div>\n            <Button onClick={handleCapture} className=\"w-full\" size=\"lg\" disabled={hasCameraPermission === false}>\n              <Camera className=\"mr-2 h-5 w-5\" /> Scan Label\n            </Button>\n            {hasCameraPermission === false && (\n              <Alert variant=\"destructive\"><AlertTitle>Camera Access Denied</AlertTitle><AlertDescription>Please allow camera access to use this feature.</AlertDescription></Alert>\n            )}\n          </div>\n        );\n      default:\n        return renderIdleContent();\n    }\n  };\n\n  return (\n    <div className='bg-background min-h-screen'>\n      <div className=\"container mx-auto max-w-2xl py-8 px-4 space-y-6\">\n        <Card className=\"w-full shadow-lg rounded-2xl\">\n          <CardHeader className='relative'>\n            {status !== 'idle' && (\n              <Button variant=\"ghost\" size=\"icon\" className=\"absolute top-4 left-4 rounded-full\" onClick={resetState}><X className=\"h-5 w-5\" /></Button>\n            )}\n            <CardTitle className=\"text-2xl font-bold text-center\">Scan Medicine</CardTitle>\n            <CardDescription className='text-center'>Upload or take a picture of your medicine label.</CardDescription>\n          </CardHeader>\n          <CardContent>{renderContent()}</CardContent>\n        </Card>\n        \n        <Card className=\"w-full shadow-lg rounded-2xl\">\n          <CardHeader><CardTitle>Recent Scans</CardTitle></CardHeader>\n          <CardContent>\n            {isLoadingScans ? (\n              <div className=\"flex justify-center items-center p-8\"><Loader2 className=\"h-8 w-8 animate-spin text-primary\" /></div>\n            ) : scansError ? (\n              <div className=\"text-center py-4 text-destructive\">\n                <p>Error loading scans. Please check permissions.</p>\n              </div>\n            ) : recentScans && recentScans.length > 0 ? (\n              <Accordion type=\"single\" collapsible className=\"w-full\">\n                {recentScans.map((scan) => (\n                  <ScanItem key={scan.id} scan={scan} onDelete={handleDeleteScan} />\n                ))}\n              </Accordion>\n            ) : (\n              <p className='text-sm text-muted-foreground text-center py-4'>No recent scans found.</p>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}